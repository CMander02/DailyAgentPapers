---
title: "Agentic Framework for Epidemiological Modeling"
authors:
  - "Rituparna Datta"
  - "Zihan Guan"
  - "Baltazar Espinoza"
  - "Yiqi Su"
  - "Priya Pitre"
  - "Srini Venkatramanan"
  - "Naren Ramakrishnan"
  - "Anil Vullikanti"
date: "2026-01-30"
arxiv_id: "2602.00299"
arxiv_url: "https://arxiv.org/abs/2602.00299"
pdf_url: "https://arxiv.org/pdf/2602.00299v2"
categories:
  - "cs.LG"
tags:
  - "Agentic Framework"
  - "Program Synthesis"
  - "Iterative Refinement"
  - "Automated Modeling"
  - "Simulation"
relevance_score: 7.5
---

# Agentic Framework for Epidemiological Modeling

## 原始摘要

Epidemic modeling is essential for public health planning, yet traditional approaches rely on fixed model classes that require manual redesign as pathogens, policies, and scenario assumptions evolve. We introduce EPIAGENT, an agentic framework that automatically synthesizes, calibrates, verifies, and refines epidemiological simulators by modeling disease progression as an iterative program synthesis problem. A central design choice is an explicit epidemiological flow graph intermediate representation that links scenario specifications to model structure and enables strong, modular correctness checks before code is generated. Verified flow graphs are then compiled into mechanistic models supporting interpretable parameter learning under physical and epidemiological constraints. Evaluation on epidemiological scenario case studies demonstrates that EPIAGENT captures complex growth dynamics and produces epidemiologically consistent counterfactual projections across varying vaccination and immune escape assumptions. Our results show that the agentic feedback loop prevents degeneration and significantly accelerates convergence toward valid models by mimicking professional expert workflows.

## Q&A 论文解读

### Q1: 这篇论文试图解决什么问题？

这篇论文旨在解决传统流行病学建模方法在面对不断变化的病原体特征、公共卫生政策和情景假设时，灵活性和自动化程度不足的问题。研究背景是，流行病学模型是公共卫生规划的核心工具，尤其在COVID-19大流行期间，多模型集合（如情景建模中心）对指导政策至关重要。然而，现有方法严重依赖专家手动设计固定的模型类别（如SEIR及其扩展），一旦情景假设（如新变种出现、免疫逃逸、疫苗接种策略）发生变化，就需要耗时耗力地重新设计模型结构、修订逻辑并重新实现模拟器，这限制了建模的规模化和响应速度。

尽管以大型语言模型（LLM）为代表的智能体（Agent）系统已在代码合成等科学工作流自动化中展现出潜力，但将其直接应用于更复杂的流行病学建模时，往往会产生结构不一致、行为脆弱的模型。因此，本文要解决的核心问题是：能否开发一个智能体框架来自动化流行病学模型的构建、校准与验证流程？具体而言，论文提出了EPIAGENT框架，其核心是将疾病进展建模为一个迭代的程序合成问题，通过引入一个明确的流行病学流图中间表示来桥接自然语言描述的情景规范与数学模型结构。该框架旨在自动合成、校准、验证和精炼流行病学模拟器，确保生成的模型在满足流行病学理论硬约束（如参数非负性、守恒律）的同时，能准确拟合观测数据，并针对不同干预假设产生符合流行病学逻辑的反事实预测，从而模仿专家工作流，显著加速有效模型的收敛过程。

### Q2: 有哪些相关研究？

本文的相关工作主要可分为三类：流行病学建模、数据驱动的模型发现以及智能体驱动的科学建模系统。

在**流行病学建模**方面，已有研究如COVID-19情景建模中心展示了集成多种机制模型和统计模型进行预测的价值。然而，这些传统方法通常依赖固定的模型结构，当病原体、政策或免疫假设变化时，需要人工重新设计模型。本文提出的EPIAGENT框架则旨在自动化这一建模过程，通过显式的流程图表征来确保结构一致性，并能根据新情景自动调整模型结构，而非仅重新估计参数。

在**从数据中发现方程和物理模型**方面，相关工作包括符号回归、稀疏辨识和系统辨识，以及神经ODE和物理信息神经网络等。这些方法侧重于从数据中学习动力学方程或连续时间动态。但流行病学模拟器具有特殊性，它们编码了结构化的仓室转换和情景驱动的干预逻辑，并用于反事实和机制性推理。黑盒组件或固定拓扑可能损害其可解释性和科学有效性。EPIAGENT则强调生成具有明确机制结构、符合流行病学约束的可解释模型。

在**智能体科学建模系统**方面，近期研究利用大语言模型进行程序合成、修复和迭代优化，或构建自动化研究流程的“AI科学家”框架。这些系统主要关注语法正确性和经验性能，通常缺乏领域特定的机制约束，或将结构修订作为核心操作。EPIAGENT针对这一不足，将流行病模拟器构建视为一个由情景驱动的智能体过程，显式地表征和验证机制结构，并将验证环节集成到生成循环中，从而支持可靠的反事实分析。

### Q3: 论文如何解决这个问题？

论文通过构建一个名为EPIAGENT的智能体框架来解决传统流行病学建模方法依赖固定模型类别、需要手动重新设计的问题。其核心方法是将疾病进展建模为一个迭代的程序合成问题，通过自动化合成、校准、验证和精炼流行病学模拟器来实现。

整体框架是一个多阶段的智能体管道。主要模块包括：1）**知识增强提示生成**：首先，系统接收自然语言场景描述，使用句子转换器模型进行嵌入，并通过基于FAISS的向量索引从精选语料库中检索相关流行病学知识，形成知识增强的提示，为模型构建奠定理论基础。2）**流行病学流图生成与验证**：这是架构的核心创新点。系统将流图生成构建为一个迭代的、知识引导的合成过程。生成的流图首先经过**迭代验证循环**，包括基于硬性结构约束（如允许的仓室和转移）的检查，以及一个**智能体验证循环**，该循环评估场景一致性并要求对每个转移提供流行病学理由。验证失败会触发带有明确错误反馈的重新生成，确保只有通过结构和场景特定标准验证的有效流图才会进入下一阶段。这种图级别的验证防止了无效结构传播到可执行代码中。3）**可执行模拟器生成与校准**：给定验证后的流图和疾病规格，一个**LLM规划智能体**利用预定义的可执行代码骨架（固定执行接口但流行病学逻辑灵活）来实例化微分方程模型并生成可执行代码。此过程辅以**约束引导提示**，包括确保有效流行病结构（如数值稳定性、仓室一致性）和执行安全性的硬约束，以及鼓励可解释设计的软约束。代码生成配备**错误恢复模块**，能捕获运行时错误并反馈给编码智能体进行修订。4）**参数校准与验证**：生成的模拟器使用基于梯度的优化方法，通过最小化感染和死亡数据的均方误差及其一阶差分来校准疾病参数。参数在场景间共享以确保差异源于机制而非独立重拟合。5）**验证与确认模块**：系统通过自动化的LLM驱动模块进行严格的验证与确认，包括：**验证模块**（检查代码与流图一致性、状态参数非负性、人口质量守恒、数值稳定性）、**模型推理模块**（解释代码和模型结构以提高可解释性）、**验证模块**（评估模拟结果的合理性和场景保真度）以及**性能反馈模块**（根据校准和验证结果提供针对性反馈以指导模型迭代精炼）。

关键技术包括：将场景规范通过**显式的流行病学流图中间表示**与模型结构链接，实现模块化的强正确性检查；采用**智能体反馈循环**模仿专家工作流程，防止退化并加速收敛到有效模型；以及通过**骨架代码与约束分离**的设计，既保证了自动执行和训练，又保持了模型逻辑的灵活性。创新点在于将程序合成和智能体技术系统性地应用于流行病学建模，通过流图这一中间表示和多重自动化验证，实现了从自然语言描述到可校准、可解释的机制模型的端到端自动化构建。

### Q4: 论文做了哪些实验？

论文实验主要包括两个案例研究。实验设置上，使用GPT-4o-mini生成流行病学流程图，GPT-4.1进行规划和代码生成，验证和反馈代理使用GPT-4.1-mini以控制成本。知识检索采用sentence-transformer嵌入和FAISS索引。所有模拟器在PyTorch环境中使用Adam优化器进行校准，并在NVIDIA Tesla V100 GPU上运行。

数据集与基准测试方面，**案例研究I**使用了COVID-19 Scenario Modeling Hub档案中的19轮情景建模案例，每轮包含关于干预、疫苗接种和免疫力的结构化假设以及相应的流行病学时间序列数据。**案例研究II**则在真实世界数据上评估校准和概率预测，使用了来自四个异质地点的公开COVID-19监测数据（包括死亡报告、移动行为信号和季节性协变量），并应用标准的行为SEIR模型。

对比方法上，论文进行了有针对性的消融实验，以评估关键设计选择的影响：1) 移除流程图验证；2) 移除外部知识检索（无RAG）；3) 移除流程图中间表示（即直接进行情景到代码的生成）。

主要结果与关键指标如下：
1.  **校准准确性**：生成的模拟器能够捕捉关键时间特征（如总体增长动态和峰值时间）。在预测准确性上，允许时变参数（如β(t), γ(t)）或引入神经组件可以提升短期预测精度。例如，在国家级预测中，时变动态模型的MAE为4.26e-2，MSE为2.53e-3，RMSE为5.03e-2；而加入神经组件的模型性能更优，MAE为2.22e-2，MSE为7.13e-4，RMSE为2.67e-2。
2.  **结构正确性**：验证机制至关重要。消融实验表明，**没有流程图验证**时，超过87%的案例会产生不正确的预测。**没有外部知识检索**时，模型会默认生成最简单的SEIRD式流程图，忽略特定机制，而知识引导能将带反馈的流程图生成迭代次数平均减少约20%。**没有流程图中间表示**（直接生成）会导致代码中出现频繁的结构错误。
3.  **反事实推理**：在案例研究I的六个反事实情景（涉及不同疫苗接种策略和免疫逃逸水平）中，生成的模拟器表现出强大的流行病学一致性。例如，在高免疫逃逸情景下，累计感染数更高；增加疫苗接种覆盖率会单调降低感染负担。
4.  **代理反馈效果**：迭代的代理反馈显著加速了收敛，通过纠正结构违规和细化模型表达能力，模仿了专家工作流程。
5.  **通用性**：案例研究II表明，该框架可以实例化、校准标准的行为流行病学模型（如DDB模型），并生成捕捉关键趋势和峰值时间、带有不确定性区间的概率预测。

### Q5: 有什么可以进一步探索的点？

该论文的局限性在于其优化过程是固定的，且迭代精炼有界，这可能导致后期因噪声累积而出现性能回退。未来研究可探索收敛感知的校准方法和自适应停止准则，以提升系统鲁棒性。此外，当前框架主要依赖预设的流行病学流程图中间表示，未来可考虑引入更灵活的知识表示方式，如结合图神经网络动态学习疾病传播模式。另一个方向是扩展多智能体协作机制，融入实时数据流进行在线学习和模型调整，以应对突发疫情变化。从更广视角看，可将该框架与因果推断方法结合，增强对干预效果的反事实解释能力，并探索在资源受限环境下的轻量化部署方案。

### Q6: 总结一下论文的主要内容

该论文提出了一个名为EPIAGENT的智能体框架，旨在解决传统流行病学建模方法依赖固定模型、难以适应病原体、政策和场景假设动态变化的问题。其核心贡献是将疾病传播建模构建为一个迭代的程序合成问题，从而自动合成、校准、验证和优化流行病学模拟器。

方法上，该框架引入了一个关键的流行病学流程图中间表示，它将场景规范与模型结构联系起来，允许在代码生成前进行模块化的强正确性检查。经验证的流程图随后被编译成支持物理解释的机制模型，并在物理与流行病学约束下进行可解释的参数学习。

主要结论显示，EPIAGENT通过模仿专家工作流程的智能体反馈循环，有效防止了模型退化，并显著加速了有效模型的收敛。在多个案例研究中，该框架成功捕捉了复杂的增长动态，并在不同的疫苗接种和免疫逃逸假设下，产生了流行病学意义上一致的反事实预测，提升了建模的自动化程度与适应性。
