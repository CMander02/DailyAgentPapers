---
title: "PoCo: Agentic Proof-of-Concept Exploit Generation for Smart Contracts"
authors:
  - "Vivi Andersson"
  - "Sofia Bobadilla"
  - "Harald Hobbelhagen"
  - "Martin Monperrus"
date: "2025-11-04"
arxiv_id: "2511.02780"
arxiv_url: "https://arxiv.org/abs/2511.02780"
pdf_url: "https://arxiv.org/pdf/2511.02780v3"
categories:
  - "cs.CR"
  - "cs.AI"
  - "cs.SE"
tags:
  - "Agentic Framework"
  - "Multi-Agent System"
  - "Tool Use"
  - "Reasoning and Acting"
  - "Code Generation"
  - "Security Auditing"
  - "Smart Contracts"
  - "Automated Exploit Generation"
relevance_score: 8.5
---

# PoCo: Agentic Proof-of-Concept Exploit Generation for Smart Contracts

## 原始摘要

Smart contracts operate in a highly adversarial environment, where vulnerabilities can lead to substantial financial losses. Thus, smart contracts are subject to security audits. In auditing, proof-of-concept (PoC) exploits play a critical role by demonstrating to the stakeholders that the reported vulnerabilities are genuine, reproducible, and actionable. However, manually creating PoCs is time-consuming, error-prone, and often constrained by tight audit schedules. We introduce PoCo, an agentic framework that automatically generates executable PoC exploits from natural-language vulnerability descriptions written by auditors. PoCo autonomously generates PoC exploits in an agentic manner by interacting with a set of codeexecution tools in a Reason-Act-Observe loop. It produces fully executable exploits compatible with the Foundry testing framework, ready for integration into audit reports and other security tools. We evaluate PoCo on a dataset of 23 real-world vulnerability reports. PoCo consistently outperforms the Zero-shot and Workflow baselines, generating well-formed and logically correct PoCs. Our results demonstrate that agentic frameworks can significantly reduce the effort required for high-quality PoCs in smart contract audits. Our contribution provides actionable knowledge for the smart contract security community.

## Q&A 论文解读

### Q1: 这篇论文试图解决什么问题？

这篇论文旨在解决智能合约安全审计中概念验证（PoC）漏洞利用代码自动化生成的问题。研究背景是智能合约运行在高度对抗的环境中，漏洞可能导致巨额财务损失（截至2025年10月已造成约150亿美元损失），因此安全审计至关重要。在审计过程中，PoC对于向利益相关方证明漏洞的真实性、可复现性和可操作性具有关键作用。

现有方法的不足主要体现在：手动创建PoC耗时耗力、容易出错，且受限于紧张的审计周期；而以往的自动化方法要么仅生成区块链交易序列而非可执行的测试代码，要么只关注可直接提取资金的漏洞类型，或者采用无法适应真实世界智能合约软件项目的固定流水线，缺乏灵活性。

本文要解决的核心问题是：如何从审计人员撰写的自然语言漏洞描述中，自动生成可执行的PoC漏洞利用代码。为此，论文提出了PoCo——一个基于智能体（agentic）的框架，通过“推理-执行-观察”循环与代码执行工具交互，自主生成与Foundry测试框架兼容的、可直接执行的PoC。该方法旨在显著降低高质量PoC的生成成本，提高审计效率，帮助更彻底地记录漏洞并加速修复，从而降低可被利用合约进入生产环境的风险。

### Q2: 有哪些相关研究？

本文的研究主要涉及智能合约安全、AI辅助代码生成以及智能体（Agent）框架等领域。相关研究可按类别梳理如下：

**1. 智能合约安全与漏洞检测工具**
传统研究侧重于自动化漏洞检测（如静态分析工具Slither、Oyente，动态分析工具Mythril），这些工具能识别漏洞模式，但通常不生成可执行的PoC漏洞利用证明。本文的PoCo框架则向前推进了一步，专注于将已识别的漏洞描述（自然语言）自动转化为可运行的PoC，弥补了从“发现问题”到“验证问题”之间的自动化空白。

**2. AI辅助代码生成与程序合成**
基于大语言模型（LLM）的代码生成模型（如Codex、CodeLlama）能够根据注释或描述生成代码片段，但它们通常是单轮、静态的生成，缺乏与执行环境交互、迭代调试的能力。PoCo采用了**智能体（Agentic）框架**，通过“推理-执行-观察”循环与代码执行工具交互，从而动态地生成、测试并修正PoC，这超越了传统代码生成的范式。

**3. 智能体（Agent）框架在编程任务中的应用**
近期研究探索了将LLM与工具使用、任务分解相结合，以完成复杂任务（如AutoGPT、MetaGPT等）。PoCo属于此类“AI for Code”领域的智能体应用，但其目标高度特定：专注于智能合约漏洞的PoC生成。与通用编程智能体相比，PoCo需要深入理解智能合约特有的操作复杂性（如多交易顺序、状态初始化）和语义隐式约束，这是其区别于其他智能体框架的关键。

**4. 智能合约审计与PoC生成的相关工作**
在审计领域，现有工作主要集中在漏洞分类和报告标准化，但自动化PoC生成工具仍很缺乏。一些研究尝试用形式化方法或脚本模板生成测试用例，但通常依赖预定义模式，难以适应真实审计报告中多样、模糊的自然语言描述。PoCo直接针对审计师撰写的漏洞描述进行端到端PoC生成，并输出与主流测试框架（Foundry）兼容的代码，实用性更强。

总之，PoCo与现有工作的核心区别在于：它首次将**智能体框架**系统性地应用于**从自然语言漏洞描述生成可执行PoC**这一特定、高难度的安全工程任务，通过与环境交互的迭代机制，解决了PoC构造中的语义隐式性和操作复杂性挑战，从而在真实场景中提升了审计效率。

### Q3: 论文如何解决这个问题？

论文通过构建一个名为PoCo的自主智能体框架来解决智能合约审计中手动创建概念验证（PoC）漏洞利用耗时且易错的问题。其核心方法是采用一个单一的大型语言模型（LLM）智能体，在一个“推理-行动-观察”（ReAct-style）的循环中，与一组外部工具交互，自主生成可执行的PoC。

**整体框架与架构设计**：PoCo是一个单智能体系统，其架构将LLM与一组用于编译、执行和探索的外部工具耦合。智能体拥有完全的自主权来选择、排序和配置工具调用。框架本身只提供最小化的脚手架，主要用于暴露工具接口和管理输入输出流，这确保了系统不会过度依赖单一模型，并能灵活适应工具的变更。

**主要模块与组件**：
1.  **基础工具集**：提供文件系统探索和修改能力，包括文件搜索（`glob`, `grep`）、文件读取（`read`）以及文件编辑或写入（`edit`, `write`）。
2.  **任务规划工具**：通过一个轻量级的`Todo`接口，帮助智能体跟踪基于先前制定计划的进度。
3.  **领域特定工具**：
    *   `smart-contract-compile`：用于编译Solidity合约。
    *   `smart-contract-test`：在易受攻击的智能合约代码库中执行生成的PoC漏洞利用。这两个工具基于广泛使用的Foundry框架实现，使智能体能够验证其生成的PoC，并根据工具输出的关键反馈进行自我修正。
4.  **安全执行环境**：所有命令都在容器化（Docker）环境中执行，以缓解运行漏洞利用代码的潜在安全风险，并确保执行的可复现性。
5.  **提示工程**：通过系统提示词定义智能体的角色、行为准则和基于最佳实践的PoC生成蓝图（如可解释性、漏洞分析指南、框架特定语法、可执行性验证、迭代精炼提示等）。任务提示词则提供生成PoC的最小化指令，并指定相关文件路径。

**关键技术流程与创新点**：
1.  **自主的ReAct循环**：智能体遵循“推理-行动-观察”的循环，根据环境反馈自主决定后续行动，逐步迭代直至生成能成功编译并通过测试（即暴露漏洞）的PoC。
2.  **工具驱动的迭代验证与自修正**：智能体主动调用编译和测试工具，利用工具输出的成功/错误信息作为反馈，驱动对PoC代码的迭代修改和逻辑修正，这是实现高质量、可执行PoC的关键。
3.  **最小化脚手架与灵活性**：秉承“苦涩的教训”原则，系统设计最小化固定流程，将决策权交给LLM智能体，使其能够灵活适应不同的任务和工具变化。
4.  **全面的安全隔离**：通过命令白名单和容器化执行双重限制，严格约束智能体的行动空间，防止其与真实链上合约交互或访问主机敏感数据，确保生成过程的安全无害。
5.  **监控与可分析性**：系统记录完整的交互轨迹（包括提示词、响应、工具调用及返回值）和执行元数据（如令牌消耗、成本、时长），便于事后分析智能体行为。

### Q4: 论文做了哪些实验？

论文的实验设置旨在评估PoCo框架生成的漏洞概念验证（PoC）是否可执行且逻辑正确。为此，研究者构建了一个名为Proof-of-Patch的自定义数据集，该数据集包含23个真实世界的智能合约审计案例（时间跨度为2022年至2025年7月），覆盖了OWASP智能合约十大风险类别，如访问控制、重入攻击、逻辑错误等。每个案例都包含漏洞的自然语言描述、对应的安全补丁、完整的智能合约源代码以及可执行的Foundry测试框架配置。

实验的对比方法包括两种基线模型：Zero-shot（直接提示大语言模型生成PoC）和Workflow（将任务分解为多个步骤的提示链）。主要评估指标是PoC的生成成功率，即生成的漏洞利用代码是否结构良好（well-formed）且逻辑正确（logically correct）。

实验的主要结果显示，PoCo框架在23个案例的测试中，其生成成功率显著且一致地优于两种基线方法。具体而言，PoCo能够成功生成与Foundry测试框架兼容、完全可执行的PoC漏洞利用代码，这些代码可以直接整合到审计报告或其他安全工具中。关键数据指标方面，虽然提供的章节未给出具体的成功率百分比数值，但明确指出PoCo“持续超越”（consistently outperforms）了基线方法，并成功生成了结构良好且逻辑正确的PoC。这证明了其智能体框架（Reason-Act-Observe循环）能够有效减少智能合约审计中创建高质量PoC所需的工作量。

### Q5: 有什么可以进一步探索的点？

该论文提出的PoCo框架在自动化生成概念验证漏洞利用方面取得了显著进展，但其局限性和未来探索方向仍值得深入。首先，当前评估仅基于23个真实漏洞报告，样本规模有限，未来需在更广泛、更多样化的漏洞类型（如逻辑漏洞、治理攻击）上进行测试，以验证其泛化能力。其次，框架依赖审计人员提供的自然语言描述，若描述模糊或不完整，可能影响生成质量；未来可探索结合静态分析或符号执行，自动提取漏洞上下文以减少人工依赖。此外，PoCo目前生成Foundry兼容的代码，未来可扩展支持其他测试框架（如Hardhat），并集成到审计流水线中实现闭环验证。从Agent设计角度看，可引入多智能体协作机制，让专门Agent负责代码理解、攻击链构建等子任务，提升复杂漏洞的处理能力。最后，安全性与伦理风险也需考量，例如生成代码的误用可能性，需研究防护机制（如输出过滤）以确保技术负责任地应用。

### Q6: 总结一下论文的主要内容

该论文提出了PoCo，一个用于智能合约安全审计的自动化概念验证（PoC）漏洞利用生成框架。其核心问题是解决手动创建PoC存在耗时、易错且受限于紧张审计周期的问题。PoCo的方法是基于智能体（Agentic）架构，它能够接收审计人员用自然语言描述的漏洞报告，并通过一个“推理-执行-观察”的循环，自主地与一系列代码执行工具交互，最终生成与Foundry测试框架兼容、可直接执行的PoC漏洞利用代码。主要结论是，在包含23个真实漏洞报告的数据集上评估，PoCo在生成格式良好、逻辑正确的PoC方面，持续优于零样本和工作流基线方法。该工作的核心贡献在于证明了智能体框架能显著降低高质量PoC生成所需的人力成本，为智能合约安全社区提供了可直接应用的知识和工具，提升了审计效率和漏洞验证的可操作性。
